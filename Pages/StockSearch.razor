@page "/stocksearch"
@using StockApp.Models;
@using StockApp.Clients;
@inject StockClient StockClient;

<PageTitle>Watch List</PageTitle>

<div class="container px-4 px-lg-5">
    <div class="row">
        <div class="col-md-6">
            <h2>Lookup Stock</h2>

            <br>
            <p>Please enter a valid stock acronym:</p>
            <input placeholder="AACG" @bind="enteredStock" />
            <button class="btn btn-primary" @onclick="AddStock">Lookup</button> 
            <br>
            <br>
            <br>

            @if (stockResponse != null) {
                <h3>Stock Information</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Symbol</th>
                            <th>Name</th>
                            <th>Currency</th>
                            <th>Exchange</th>
                            <th>Mic Code</th>
                            <th>Country</th>
                            <th>Type</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var data in stockResponse.theData) {
                            <tr>
                                <td>@data.theSymbol</td>
                                <td>@data.theName</td>
                                <td>@data.theCurrency</td>
                                <td>@data.theExchange</td>
                                <td>@data.theMicCode</td>
                                <td>@data.theCountry</td>
                                <td>@data.theType</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }           
        </div>
    </div>
</div>

@code {

    private StockResponse? stockResponse = null;
    protected override async Task OnInitializedAsync(){
        stockResponse = await StockClient.GetStock(null);
    }

    private string? enteredStock;

    protected async Task AddStock(){
        if(enteredStock != null){
            stockResponse = await StockClient.GetStock(enteredStock);
        }
    }

}
